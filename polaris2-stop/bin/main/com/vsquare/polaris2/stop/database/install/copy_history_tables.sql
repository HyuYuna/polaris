

insert into TB_USER_HISTORY (
    history_year,
    idx                                         ,
    id                                          ,
    password                                    ,
    password_salt                               ,
    password_last_modified_date                 ,
    password_reset_question                     ,
    password_reset_answer                       ,
    password_reset_temporary_key                ,
    login_trial_count                           ,
    last_login_trial_date                       ,
    login_block_end_date                        ,
    role_code                                   ,
    service_provider_id                         ,
    institution_id                              ,
    group_id                                    ,
    organization_id                             ,
    name                                        ,
    number                                      ,
    nationality                                 ,
    social_security_number                      ,
    gender_code                                 ,
    employment_status_code                      ,
    company_name                                ,
    company_department                          ,
    company_position                            ,
    business_registration_number                ,
    business_registration_certificate_image_url ,
    education_level_code                        ,
    date_of_birth                               ,
    email                                       ,
    personal_email                              ,
    student_type_code                           ,
    year                                        ,
    department_id                               ,
    profile_image_url                           ,
    address_1                                   ,
    address_2                                   ,
    postcode                                    ,
    other_address_1                             ,
    other_address_2                             ,
    other_postcode                              ,
    home_phone_number                           ,
    mobile_phone_number                         ,
    office_phone_number                         ,
    other_phone_number                          ,
    receive_email                               ,
    receive_text_message                        ,
    receive_push_message                        ,
    receive_other_message                       ,
    referrer_type_code                          ,
    referrer_name                               ,
    picture_id_image_url                        ,
    bank_account_image_url                      ,
    is_modifiable                               ,
    level                                       ,
    need_to_update_profile                      ,
    is_dormant_warned                           ,
    is_dormant_notified                         ,
    is_delete_requested                         ,
    delete_requested_date                       ,
    delete_reason                               ,
    status_code                                 ,
    status_code_last_modified_date              ,
    is_certification_exempted                   ,
    certification_exempted_date                 ,
    allowed_to_enroll                           ,
    registered_by_user_idx                      ,
    registered_from_country                     ,
    registered_from_ip_address                  ,
    registered_from_device_type_code            ,
    registered_date                             ,
    last_modified_by_user_idx                   ,
    last_modified_from_country                  ,
    last_modified_from_ip_address               ,
    last_modified_from_device_type_code         ,
    last_modified_date
)

select

    2021 as history_year,
    idx                                         ,
    id                                          ,
    password                                    ,
    password_salt                               ,
    password_last_modified_date                 ,
    password_reset_question                     ,
    password_reset_answer                       ,
    password_reset_temporary_key                ,
    login_trial_count                           ,
    last_login_trial_date                       ,
    login_block_end_date                        ,
    role_code                                   ,
    service_provider_id                         ,
    institution_id                              ,
    group_id                                    ,
    organization_id                             ,
    name                                        ,
    number                                      ,
    nationality                                 ,
    social_security_number                      ,
    gender_code                                 ,
    employment_status_code                      ,
    company_name                                ,
    company_department                          ,
    company_position                            ,
    business_registration_number                ,
    business_registration_certificate_image_url ,
    education_level_code                        ,
    date_of_birth                               ,
    email                                       ,
    personal_email                              ,
    student_type_code                           ,
    year                                        ,
    department_id                               ,
    profile_image_url                           ,
    address_1                                   ,
    address_2                                   ,
    postcode                                    ,
    other_address_1                             ,
    other_address_2                             ,
    other_postcode                              ,
    home_phone_number                           ,
    mobile_phone_number                         ,
    office_phone_number                         ,
    other_phone_number                          ,
    receive_email                               ,
    receive_text_message                        ,
    receive_push_message                        ,
    receive_other_message                       ,
    referrer_type_code                          ,
    referrer_name                               ,
    picture_id_image_url                        ,
    bank_account_image_url                      ,
    is_modifiable                               ,
    level                                       ,
    need_to_update_profile                      ,
    is_dormant_warned                           ,
    is_dormant_notified                         ,
    is_delete_requested                         ,
    delete_requested_date                       ,
    delete_reason                               ,
    status_code                                 ,
    status_code_last_modified_date              ,
    is_certification_exempted                   ,
    certification_exempted_date                 ,
    allowed_to_enroll                           ,
    registered_by_user_idx                      ,
    registered_from_country                     ,
    registered_from_ip_address                  ,
    registered_from_device_type_code            ,
    registered_date                             ,
    last_modified_by_user_idx                   ,
    last_modified_from_country                  ,
    last_modified_from_ip_address               ,
    last_modified_from_device_type_code         ,
    last_modified_date

from TB_USER_20211231;










insert into TB_USER_PROPERTY_HISTORY
(

    history_year,
    user_idx,
    name,
    value
)
select
    2021 as history_year,
    user_idx,
    name,
    value
from TB_USER_PROPERTY_20211231;


insert into TB_COURSE_HISTORY
(

    history_year,
    id,
    operation_code                         ,
    course_content_id                      ,
    term_id                                ,
    service_title                          ,
    year                                   ,
    study_time_in_hours                    ,
    study_time_in_minutes                  ,
    study_time_in_seconds                  ,
    short_description                      ,
    properties                             ,
    course_video                           ,
    course_image_url                       ,
    course_homepage_url                    ,
    learning_method_code                   ,
    grading_method_code                    ,
    price                                  ,
    price_unit                             ,
    registration_start_date                ,
    registration_end_date                  ,
    cancellation_start_date                ,
    cancellation_end_date                  ,
    cancel_days                            ,
    start_date                             ,
    end_date                               ,
    study_days                             ,
    mark_review_start_date                 ,
    mark_review_end_date                   ,
    review_start_date                      ,
    review_end_date                        ,
    review_days                            ,
    auto_completion_confirmation           ,
    pre_registered_student_only            ,
    sequential_learning_only               ,
    offer_certificate                      ,
    certificate_template                   ,
    english_certificate_template           ,
    provide_additional_study_material      ,
    auto_enrollment                        ,
    use_enrollment_code                    ,
    enrollment_code                        ,
    max_student_count                      ,
    student_count                          ,
    completed_student_count                ,
    attachment_size_limit                  ,
    show_student_report_detail             ,
    terms_of_service_id                    ,
    is_curriculum_independent              ,
    curriculum_item_type_code              ,
    enrollment_target_code                 ,
    section_number                         ,
    first_section_course_id                ,
    allow_management_before_start_date     ,
    is_institution_exclusive               ,
    is_open_to_all_institution             ,
    is_archived                            ,
    is_modifiable                          ,
    is_available                           ,
    exclude_from_statistics                ,
    registered_by_user_idx                 ,
    registered_from_country                ,
    registered_from_ip_address             ,
    registered_from_device_type_code       ,
    registered_date                        ,
    last_modified_by_user_idx              ,
    last_modified_from_country             ,
    last_modified_from_ip_address          ,
    last_modified_from_device_type_code    ,
    last_modified_date                     ,
    view_count                             ,
    like_count                             ,
    dislike_count                          ,
    favorite_count
)
select
    2021 as history_year,
    id,
    operation_code                         ,
    course_content_id                      ,
    term_id                                ,
    service_title                          ,
    year                                   ,
    study_time_in_hours                    ,
    study_time_in_minutes                  ,
    study_time_in_seconds                  ,
    short_description                      ,
    properties                             ,
    course_video                           ,
    course_image_url                       ,
    course_homepage_url                    ,
    learning_method_code                   ,
    grading_method_code                    ,
    price                                  ,
    price_unit                             ,
    registration_start_date                ,
    registration_end_date                  ,
    cancellation_start_date                ,
    cancellation_end_date                  ,
    cancel_days                            ,
    start_date                             ,
    end_date                               ,
    study_days                             ,
    mark_review_start_date                 ,
    mark_review_end_date                   ,
    review_start_date                      ,
    review_end_date                        ,
    review_days                            ,
    auto_completion_confirmation           ,
    pre_registered_student_only            ,
    sequential_learning_only               ,
    offer_certificate                      ,
    certificate_template                   ,
    english_certificate_template           ,
    provide_additional_study_material      ,
    auto_enrollment                        ,
    use_enrollment_code                    ,
    enrollment_code                        ,
    max_student_count                      ,
    student_count                          ,
    completed_student_count                ,
    attachment_size_limit                  ,
    show_student_report_detail             ,
    terms_of_service_id                    ,
    is_curriculum_independent              ,
    curriculum_item_type_code              ,
    enrollment_target_code                 ,
    section_number                         ,
    first_section_course_id                ,
    allow_management_before_start_date     ,
    is_institution_exclusive               ,
    is_open_to_all_institution             ,
    is_archived                            ,
    is_modifiable                          ,
    is_available                           ,
    exclude_from_statistics                ,
    registered_by_user_idx                 ,
    registered_from_country                ,
    registered_from_ip_address             ,
    registered_from_device_type_code       ,
    registered_date                        ,
    last_modified_by_user_idx              ,
    last_modified_from_country             ,
    last_modified_from_ip_address          ,
    last_modified_from_device_type_code    ,
    last_modified_date                     ,
    view_count                             ,
    like_count                             ,
    dislike_count                          ,
    favorite_count
from TB_COURSE_20211231;











insert into TB_COURSE_ENROLLMENT_HISTORY
(
    history_year,
    course_id                                        ,
    student_user_idx                                 ,
    status_code                                      ,
    enrollment_count                                 ,
    study_material_delivery_status_code              ,
    study_material_delivery_status_last_modified_date,
    auditing_start_date                              ,
    auditing_end_date                                ,
    courseware_homepage_url                          ,
    unenroll_url                                     ,
    certificate_url                                  ,
    properties                                       ,
    academic_advisor_user_idx                        ,
    academic_advisor_assigned_date                   ,
    is_prepared                                      ,
    is_repeated                                      ,
    unenroll_request_status_code                     ,
    unenroll_requested_by_user_idx                   ,
    unenroll_requested_from_country                  ,
    unenroll_requested_from_ip_address               ,
    unenroll_requested_from_device_type_code         ,
    unenroll_requested_date                          ,
    unenroll_request_approved_by_user_idx            ,
    unenroll_request_approved_from_country           ,
    unenroll_request_approved_from_ip_address        ,
    unenroll_request_approved_from_device_type_code  ,
    unenroll_request_approved_date                   ,
    registered_by_user_idx                           ,
    registered_from_country                          ,
    registered_from_ip_address                       ,
    registered_from_device_type_code                 ,
    registered_date                                  ,
    last_modified_by_user_idx                        ,
    last_modified_from_country                       ,
    last_modified_from_ip_address                    ,
    last_modified_from_device_type_code             ,
    last_modified_date
)
select
    2021 as history_year,
    course_id                                        ,
    student_user_idx                                 ,
    status_code                                      ,
    enrollment_count                                 ,
    study_material_delivery_status_code              ,
    study_material_delivery_status_last_modified_date,
    auditing_start_date                              ,
    auditing_end_date                                ,
    courseware_homepage_url                          ,
    unenroll_url                                     ,
    certificate_url                                  ,
    properties                                       ,
    academic_advisor_user_idx                        ,
    academic_advisor_assigned_date                   ,
    is_prepared                                      ,
    is_repeated                                      ,
    unenroll_request_status_code                     ,
    unenroll_requested_by_user_idx                   ,
    unenroll_requested_from_country                  ,
    unenroll_requested_from_ip_address               ,
    unenroll_requested_from_device_type_code         ,
    unenroll_requested_date                          ,
    unenroll_request_approved_by_user_idx            ,
    unenroll_request_approved_from_country           ,
    unenroll_request_approved_from_ip_address        ,
    unenroll_request_approved_from_device_type_code  ,
    unenroll_request_approved_date                   ,
    registered_by_user_idx                           ,
    registered_from_country                          ,
    registered_from_ip_address                       ,
    registered_from_device_type_code                 ,
    registered_date                                  ,
    last_modified_by_user_idx                        ,
    last_modified_from_country                       ,
    last_modified_from_ip_address                    ,
    last_modified_from_device_type_code              ,
    last_modified_date
from TB_COURSE_ENROLLMENT_20211231;








insert into TB_STUDENT_REPORT_HISTORY
(
    history_year,
    course_id                                    ,
    student_user_idx                             ,
    total_learning_time_in_seconds               ,
    learning_progress                            ,
    exam_original_total_mark                     ,
    exam_total_mark                              ,
    quiz_original_total_mark                     ,
    quiz_total_mark                              ,
    assignment_original_total_mark               ,
    assignment_total_mark                        ,
    forum_original_total_mark                    ,
    forum_total_mark                             ,
    live_seminar_original_total_mark             ,
    live_seminar_total_mark                      ,
    etc_original_total_mark                      ,
    etc_total_mark                               ,
    attendance_original_total_mark               ,
    attendance_total_mark                        ,
    board_participation_original_total_mark      ,
    board_participation_total_mark               ,
    survey_participation_original_total_mark     ,
    survey_participation_total_mark              ,
    original_total_mark                          ,
    total_mark                                   ,
    ranking                                      ,
    letter_grade                                 ,
    course_completion_status_code                ,
    completion_date                              ,
    comment                                      ,
    is_completion_confirmed                      ,
    is_available                                 ,
    is_manually_modified                         ,
    registered_by_user_idx                       ,
    registered_from_country                      ,
    registered_from_ip_address                   ,
    registered_from_device_type_code             ,
    registered_date                              ,
    last_modified_by_user_idx                    ,
    last_modified_from_country                   ,
    last_modified_from_ip_address                ,
    last_modified_from_device_type_code          ,
    last_modified_date
)
select
    2021 as history_year,
    course_id                                    ,
    student_user_idx                             ,
    total_learning_time_in_seconds               ,
    learning_progress                            ,
    exam_original_total_mark                     ,
    exam_total_mark                              ,
    quiz_original_total_mark                     ,
    quiz_total_mark                              ,
    assignment_original_total_mark               ,
    assignment_total_mark                        ,
    forum_original_total_mark                    ,
    forum_total_mark                             ,
    live_seminar_original_total_mark             ,
    live_seminar_total_mark                      ,
    etc_original_total_mark                      ,
    etc_total_mark                               ,
    attendance_original_total_mark               ,
    attendance_total_mark                        ,
    board_participation_original_total_mark      ,
    board_participation_total_mark               ,
    survey_participation_original_total_mark     ,
    survey_participation_total_mark              ,
    original_total_mark                          ,
    total_mark                                   ,
    ranking                                      ,
    letter_grade                                 ,
    course_completion_status_code                ,
    completion_date                              ,
    comment                                      ,
    is_completion_confirmed                      ,
    is_available                                 ,
    is_manually_modified                         ,
    registered_by_user_idx                       ,
    registered_from_country                      ,
    registered_from_ip_address                   ,
    registered_from_device_type_code             ,
    registered_date                              ,
    last_modified_by_user_idx                    ,
    last_modified_from_country                   ,
    last_modified_from_ip_address                ,
    last_modified_from_device_type_code          ,
    last_modified_date
from TB_STUDENT_REPORT_20211231;






insert into TB_TERM_HISTORY
(
    history_year,
    id,
    institution_id ,
    organization_id                                 ,
    type_code                                       ,
    parent_id                                       ,
    curriculum_id                                   ,
    year                                            ,
    number                                          ,
    name                                            ,
    properties                                      ,
    description                                     ,
    course_attendance_check_method_code             ,
    registration_start_date                         ,
    registration_end_date                           ,
    cancellation_start_date                         ,
    cancellation_end_date                           ,
    start_date                                      ,
    end_date                                        ,
    review_start_date                               ,
    review_end_date                                 ,
    mark_review_start_date                          ,
    mark_review_end_date                            ,
    exam_start_date                                 ,
    exam_end_date                                   ,
    quiz_start_date                                 ,
    quiz_end_date                                   ,
    assignment_start_date                           ,
    assignment_end_date                             ,
    forum_start_date                                ,
    forum_end_date                                  ,
    allow_course_task_review                        ,
    terms_of_service_id                             ,
    daily_learning_limit                            ,
    is_modifiable                                   ,
    is_available                                    ,
    exclude_from_statistics                         ,
    registered_by_user_idx                          ,
    registered_from_country                         ,
    registered_from_ip_address                      ,
    registered_from_device_type_code                ,
    registered_date                                 ,
    last_modified_by_user_idx                       ,
    last_modified_from_country                      ,
    last_modified_from_ip_address                   ,
    last_modified_from_device_type_code             ,
    last_modified_date
)
select
    2021 as history_year,
    id,
    institution_id ,
    organization_id                                 ,
    type_code                                       ,
    parent_id                                       ,
    curriculum_id                                   ,
    year                                            ,
    number                                          ,
    name                                            ,
    properties                                      ,
    description                                     ,
    course_attendance_check_method_code             ,
    registration_start_date                         ,
    registration_end_date                           ,
    cancellation_start_date                         ,
    cancellation_end_date                           ,
    start_date                                      ,
    end_date                                        ,
    review_start_date                               ,
    review_end_date                                 ,
    mark_review_start_date                          ,
    mark_review_end_date                            ,
    exam_start_date                                 ,
    exam_end_date                                   ,
    quiz_start_date                                 ,
    quiz_end_date                                   ,
    assignment_start_date                           ,
    assignment_end_date                             ,
    forum_start_date                                ,
    forum_end_date                                  ,
    allow_course_task_review                        ,
    terms_of_service_id                             ,
    daily_learning_limit                            ,
    is_modifiable                                   ,
    is_available                                    ,
    exclude_from_statistics                         ,
    registered_by_user_idx                          ,
    registered_from_country                         ,
    registered_from_ip_address                      ,
    registered_from_device_type_code                ,
    registered_date                                 ,
    last_modified_by_user_idx                       ,
    last_modified_from_country                      ,
    last_modified_from_ip_address                   ,
    last_modified_from_device_type_code             ,
    last_modified_date
from TB_TERM_20211231;


